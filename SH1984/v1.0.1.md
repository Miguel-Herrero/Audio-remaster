# Audio Reconstruction Notes – Sherlock Holmes (1984)

The final track seeks maximum fidelity to the English video master while preserving Spanish dialogue without perceptible loss.

## Tools
- MakeMKV v1.8.2 [darwin(arm64-release)]
- ffmpeg version 8.0
- MVSEP
- Reaper v7.46/macOS-arm64
- mkvmerge v94.0 ('Initiate') 64-bit

## Sources
- **Video**: 2025 4K AI remaster by Owen Davies, 23.976 fps
- **Audio VOX (Spanish)**: Llamentol DVD (AC3 2.0, 25 fps)
- **Audio M&E (English)**: Blu-ray LPCM 2.0
- **Audio M&E (Japanese)**: Blu-ray LPCM 2.0
- **Subtitles (English)**: 2025 4K AI remaster by Owen Davies, 23.976 fps

## Process
1. **Extraction**
- Spanish DVD extracted into MKV with MakeMKV
- Spanish audio extracted to FLAC with ffmpeg:
  ```bash
  ffmpeg -i dvd.mkv -map 0:a:0 -c:a flac es_source.flac
  ```
- English audio extracted to FLAC with ffmpeg:
  ```bash
  ffmpeg -i 4K.mkv -map 0:a:0 -c:a flac en_source.flac
  ```

2. **Frame Rate Conversion**
- Spanish VOX converted from 25 fps to 23.976 fps to match Blu-ray timing:
  ```bash
  ffmpeg -i es_source.flac -ar 48000 -filter:a "atempo=0.95904" es_23976.flac
  ```

3. **Audio Separation**
- Spanish VOX track extracted from `es_23976.flac` using MVSEP:
  - Model: "BS Roformer (vocals, instrumental), version 2025.07"
  - Output: `es_vox_24bit.flac` as FLAC (lossless, 24 bit)
- English Music & Effects track extracted `en_source.flac` using MVSEP:
  - Model: "BS Roformer (vocals, instrumental), version 2025.07"
  - Output: `en_me_24bit.flac` as FLAC (lossless, 24 bit)

4. **Audio Mixing**
- Imported `es_vox_24bit.flac` and `en_me_24bit.flac` into Reaper:
  - Synchronized tracks using visual waveform alignment
  - Manual correction of silences or gaps using samples from the M&E track
  - Applied EQ processing to Spanish VOX track using "VST: ReaEQ (Cockos)" to reduce microphone artifacts:
    - Band 1: High-pass filter at 80 Hz, -∞ dB, 2.00 octaves
    - Band 2: Band filter at 180 Hz, -3 dB, 1.00 octave
    - Band 3: Band filter at 400 Hz, -2 dB, 1.20 octaves
    - Band 4: Low-shelf filter at 5000 Hz, -3 dB, 2.00 octaves
  - Applied filtering background noise using: "VST: ReaFir (FFT EQ+Dynamics Processor) (Cockos)"
    - Mode: Subtract.
    - Automatically generated filter based on noise profile.
  - Master exported as 16-bit FLAC 48 KHz (compression level 8) as `es_reconstructed.flac`
  - Save reconstructed VOX-only track as 16-bit FLAC 48 KHz (compression level 8) as `SH84_S02E03_ES_VOX_FLAC16_23976.flac`

5. **Audio Compression**
- Japanese and English PCM tracks compressed to FLAC for file size optimization:
  ```bash
  ffmpeg -i bluray.mkv -map 0:a:0 -c:a flac en.flac
  ffmpeg -i bluray.mkv -map 0:a:1 -c:a flac ja.flac
  ```

6. **Final Export**
- Multiplexed into MKV with mkvmerge, including all audio tracks:
  - Spanish (Audio Reconstructed): `es_reconstructed.flac`
  - English: `en.flac`
  - Japanese: `ja.flac`
  - English and Japanese subtitles
  ```
  mkvmerge -o "Sherlock Holmes.s01e03.The Naval Treaty.mkv" \
  	--title "Sherlock Holmes (1984) S01E03: The Naval Treaty" \
  	--video-tracks 0 \
  	--no-audio \
  	--disable-track-statistics-tags \
  	--subtitle-tracks 3,5 \
  	--forced-display-flag 3:0 --forced-display-flag 5:0 \
  	--default-track-flag 3:0 --default-track-flag 5:0 \
  	/Users/miguelherrerobaena/Movies/s01e03/00_sources/Sherlock\ Holmes.s01e03.The\ Naval\ Treaty.mkv \
  	--language 0:spa --default-track-flag 0:1 --disable-track-statistics-tags --track-name 0:"Audio reconstruido" \
  	/Users/miguelherrerobaena/Movies/s01e03/finals/ES_MIX.flac \
  	--language 0:eng --default-track-flag 0:0 --disable-track-statistics-tags --original-flag 0:1  \
  	/Users/miguelherrerobaena/Movies/s01e03/finals/en.flac \
  	--language 0:jpn --default-track-flag 0:0 --disable-track-statistics-tags  \
  	/Users/miguelherrerobaena/Movies/s01e03/finals/ja.flac \
  	--track-order 0:0,2:0,1:0,3:0,0:5,0:3
  ```

- Remux 4K video:
  ```
  ffmpeg -i /Users/miguelherrerobaena/Movies/s01e01/00_source/The\ Adventures\ of\ Sherlock\ Holmes\ \(1984\)\ -\ S01E01\ -\ A\ Scandal\ in\ Bohemia\ -\ 4K\ AI\ Remaster.webm \
  -i PREVIOUS_MULTIPLEXED_VIDEO.mkv \
  -i /Users/miguelherrerobaena/Movies/s01e01/00_source/The\ Adventures\ of\ Sherlock\ Holmes\ \(1984\)\ -\ S01E01\ -\ A\ Scandal\ in\ Bohemia\ -\ 4K\ AI\ Remaster.en-GB.vtt \
  -map 0:v -map 1:a -map 2:s \
  -c:v copy -c:a copy -c:s srt \
  -metadata:s:s:0 language=eng \
  "Sherlock Holmes.4K.s01e01.A Scandal in Bohemia.mkv"
  ```